let FasterJs={config:{basePathName:null,mode:"hash",modes:["hash","history"],componentsTransitions:!1,loadingLayer:!1},tools:{refreshLinks(){let e=FasterJs;document.querySelectorAll("[data-faster-link]").forEach((t=>{let o=t.cloneNode(!0);if(t.parentNode.replaceChild(o,t),"history"===e.config.mode){let t=window.location.origin+(e.config.basePathName+o.getAttribute("href")).replace("//","/");"a"===o.tagName.toLowerCase()&&o.setAttribute("href",t),o.addEventListener("click",(t=>{t.preventDefault(),e.router.goTo(o.getAttribute("data-faster-link"))}))}else"a"===o.tagName.toLowerCase()&&o.setAttribute("href",("#!/"+o.getAttribute("href")).replace("//","/"));o.addEventListener("click",(t=>{"history"===e.config.mode&&t.preventDefault(),e.router.goTo(o.getAttribute("data-faster-link"))}))}))}},router:{baseRoute:"/",routes:[],fallbacks:{noRoutes:null,routeNameNotFound:null,routeNotRegistered:null},currentRoute(){let e=FasterJs;if("hash"===e.config.mode)return window.location.hash.replace("#!","");{let t=window.location.origin,o=window.location.href.replace(`${t+e.config.basePathName}`,"");return""!==o?"/"+o.replace(/\/+$/,""):"/"}},goTo(e,t={}){let o=FasterJs;if(e.includes("/"))if("history"===o.config.mode){let n=window.location.origin+(o.config.basePathName+e).replace("//","/");history.pushState({route:e,params:t},"",n)}else window.location.hash=`#!/${e}`.replace("//","/");else{let t=o.router.routes,n=null;t.forEach(((t,o)=>{t.name===e&&(n=t.path)})),n?o.router.goTo(n):o.router.throwError("routeNameNotFound")}},register(e){this.routes.length>0?this.routes.forEach(((t,o)=>{e.forEach(((e,n)=>{e.name===t.name?this.routes[o]={name:e.name,path:e.path,view:e.view?e.view:null,on:e.on?e.on:null,before:e.before?e.before:null,after:e.after?e.after:null}:this.routes.push({name:e.name,path:e.path,view:e.view?e.view:null,on:e.on?e.on:null,before:e.before?e.before:null,after:e.after?e.after:null})}))})):e.forEach(((e,t)=>{this.routes.push({name:e.name,path:e.path,view:e.view?e.view:null,on:e.on?e.on:null,before:e.before?e.before:null,after:e.after?e.after:null})}))},throwError(e){let t=FasterJs,o={config:{mode:t.config.mode,el:document.querySelector("[data-faster-app]")},router:{baseRoute:this.baseRoute,currentRoute:this.currentRoute(),fallback:e,goTo:this.goTo}};this.fallbacks[e]?this.fallbacks[e](o):document.querySelector(`[data-faster-fallback][data-faster-fallback-type=${e}]`)?t.view(e):console.log(`router fallback error: ${e}`)},init(){let e=FasterJs,t=document.querySelector("[data-faster-app] > [data-faster-loading]"),o="routeNotRegistered",n={},r={config:{mode:e.config.mode,el:document.querySelector("[data-faster-app]")},route:{},router:{baseRoute:this.baseRoute,currentRoute:this.currentRoute(),goTo:this.goTo},view:e.view};if([...document.querySelectorAll("[data-faster-component], [data-faster-fallback], [data-faster-event]")].forEach((t=>{e.config.componentsTransitions?t.style.visibility="hidden":t.style.display="none"})),t&&(e.config.loadingLayer||(t.style.display="none")),e.events.beforeRouteEnter&&e.events.beforeRouteEnter(r),"hash"===e.config.mode&&["","#","#!"].includes(window.location.hash))this.goTo(this.baseRoute);else{if(this.routes.length>0){let e=this.routes.filter((e=>!e.path.includes(":"))),t=this.routes.filter((e=>e.path.includes(":")));for(let t in e)if(e[t].path===this.currentRoute()){o=null,n=e[t],r.route={name:e[t].name,path:e[t].path};break}if(o){let e=this.currentRoute(),a=e.split("/").slice(1);for(let o in t){let i=t[o].path,l=new RegExp(i.replace(/:[^\s/]+/g,"([\\w-]+)")),s=i.split("/").slice(1),u=i.match(/:[^\s/]+/g),c=e.match(l);if(a.length===s.length&&c){n=t[o];let e={},a=[...c.slice(1)];u.forEach(((t,o)=>{e[t.replace(":","")]=a[o]})),r.route={name:n.name,path:c[0],params:e};break}}Object.keys(n).length>0&&(o=null)}}else o="noRoutes";o?this.throwError(o):(n.before&&n.before(r),n.view&&e.view(n.view),n.on&&n.on(r),n.after&&n.after(r)),e.events.routeEntered&&e.events.routeEntered(r)}}},events:{beforeInit:null,init:null,beforeRouteEnter:null,routeEntered:null,loaded:null,ononline:null,onoffline:null},view(e){let t=FasterJs;[...document.querySelectorAll("[data-faster-app] [data-faster-component]"),...document.querySelectorAll("[data-faster-app] [data-faster-fallback]")].forEach((o=>{o.getAttribute("data-faster-component-id")===e||o.getAttribute("data-faster-fallback-type")===e?(t.config.componentsTransitions?o.style.visibility="visible":o.style.display="block",o.setAttribute("data-faster-component-activity","active")):(t.config.componentsTransitions?o.style.visibility="hidden":o.style.display="none",o.setAttribute("data-faster-component-activity",""))}))},init(){if(document.querySelector("html").style.scrollBehavior="smooth",0===document.querySelectorAll("[data-faster-app]").length)return document.body.innerHTML="Error: open console tool to review it.",void console.log("Error: no ([data-faster-app]) element detected in <body>.");if(document.querySelectorAll("[data-faster-app]").length>1)return document.body.innerHTML="Error: open console tool to review it.",void console.log("Error: more than one ([data-faster-app]) element detected in <body>. Only one element should be.");if(null===this.config.basePathName)return document.querySelector("[data-faster-app]").innerHTML="Error: open console tool to review it.",void console.log("Error: no (Faster.config.basePathName) path value passed.");let e={config:{mode:this.config.mode,el:document.querySelector("[data-faster-app]")},router:{baseRoute:this.router.baseRoute,currentRoute:this.router.currentRoute(),goTo:this.router.goTo},view:this.view};if(this.tools.refreshLinks(),"history"===this.config.mode){if(""!==window.location.hash)return void(window.location.href=window.location.origin+window.location.pathname);window.onpopstate=e=>{this.router.init()}}else window.onhashchange=()=>{this.router.init()};this.events.beforeInit&&this.events.beforeInit(e),window.onload=()=>{this.events.init&&this.events.init(e),this.router.init(),this.events.loaded&&this.events.loaded(e),this.config.loadingLayer&&setTimeout((()=>{document.querySelector("[data-faster-loading]").classList.add("loaded")}),1)},window.addEventListener("online",(t=>{this.events.ononline?this.events.ononline(e,t):console.log("router event key: ononline")})),window.addEventListener("offline",(t=>{this.events.onoffline?this.events.onoffline(e,t):console.log("router event key: onoffline")}))}};
